{"version":3,"sources":["webpack:///./src/pages/decode.js","webpack:///./node_modules/bech32/index.js"],"names":["BlogIndex","state","decodeAddr","upDecodeAddr","evt","setState","target","value","onEncodeAddress","addr","payload","bech32","data","words","hashType","codeHash","args","Buffer","from","slice","toString","alert","Error","lockHash","ckbUtils","render","this","siteTitle","props","site","siteMetadata","title","location","style","marginBottom","rhythm","width","type","name","onChange","onClick","React","Component","pageQuery","ALPHABET","ALPHABET_MAP","z","length","x","charAt","undefined","TypeError","polymodStep","pre","b","prefixChk","prefix","chk","i","c","charCodeAt","v","__decode","str","LIMIT","lowered","toLowerCase","uppered","toUpperCase","split","lastIndexOf","wordChars","push","convert","inBits","outBits","pad","bits","maxV","result","module","exports","decodeUnsafe","res","apply","arguments","decode","encode","toWordsUnsafe","bytes","Array","isArray","toWords","fromWordsUnsafe","fromWords"],"mappings":"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","file":"component---src-pages-decode-js-e3dabf8a6c5cd7fe7212.js","sourcesContent":["import * as ckbUtils from '@nervosnetwork/ckb-sdk-utils'\nimport * as bech32 from \"bech32\";\n\nimport React from \"react\"\nimport { graphql } from \"gatsby\"\n\nimport Layout from \"../components/layout\"\nimport SEO from \"../components/seo\"\nimport { rhythm } from \"../utils/typography\"\n\nconst SECP256K1_BLAKE160_SIGHASH_ALL_TYPE_HASH = '0x9bd7e06f3ecf4be0f2fcd2188b23f1b9fcc88e5d4b65a8637b17723bbda3cce8'\nconst SECP256K1_BLAKE160_MULTISIG_ALL_TYPE_HASH = \"0x5c5069eb0857efc65e1bca0c07df34c31663b3622fd3876c876320fc9634e2a8\"\n\nclass BlogIndex extends React.Component {\n  state = {\n    decodeAddr: '',\n  }\n\n  upDecodeAddr= (evt) =>{\n    this.setState({\n      decodeAddr: evt.target.value\n    });\n  }\n\n  onEncodeAddress = () => {\n    const addr = this.state.decodeAddr\n    const payload = bech32.decode(addr, 95)\n    const data = bech32.fromWords(payload.words)\n    let hashType = ''\n    let codeHash = ''\n    let args = ''\n\n    // https://github.com/ququzone/keyper/blob/master/packages/specs/src/address.ts#L16-L51\n\n    if (data[0] === 1) {\n      // short address\n      if (data[1] === 0) {\n        // SECP256K1 + blake160\n        hashType = \"type\"\n        codeHash = SECP256K1_BLAKE160_SIGHASH_ALL_TYPE_HASH\n        args = `0x${Buffer.from(data.slice(2)).toString(\"hex\")}`\n      } else if (data[1] === 1) {\n        // SECP256K1 + multisig\n        hashType = \"type\"\n        codeHash = SECP256K1_BLAKE160_MULTISIG_ALL_TYPE_HASH\n        args = `0x${Buffer.from(data.slice(2)).toString(\"hex\")}`\n      } else {\n        alert(`Invalid address: ${addr}`)\n        throw new Error(`Invalid address: ${addr}`)\n      }\n\n    } else if (data[0] === 2) {\n      // long hash_type: data\n      hashType = \"data\"\n      codeHash = `0x${Buffer.from(data.slice(1, 33)).toString(\"hex\")}`\n      args = `0x${Buffer.from(data.slice(33)).toString(\"hex\")}`\n    } else if (data[0] === 4) {\n      // long hash_type: type\n      hashType = \"type\"\n      codeHash = `0x${Buffer.from(data.slice(1, 33)).toString(\"hex\")}`\n      args = `0x${Buffer.from(data.slice(33)).toString(\"hex\")}`\n    } else {\n      alert(`Invalid address: ${addr}`)\n      throw new Error(`Invalid address: ${addr}`);\n    }\n\n    const lockHash = ckbUtils.scriptToHash({\n      hashType: hashType,\n      codeHash: codeHash,\n      args: args,\n    })\n\n    this.setState({\n      addr,\n      hashType,\n      args,\n      codeHash,\n      lockHash,\n    })\n  }\n\n  render() {\n    if (!this.state) return null\n    const { data } = this.props\n    const siteTitle = data.site.siteMetadata.title\n    const {addr, hashType, args, codeHash, lockHash } = this.state\n\n    return (\n      <Layout location={this.props.location} title={siteTitle}>\n        <SEO title=\"Decode\" />\n        <h3\n          style={{\n            marginBottom: rhythm(1),\n          }}\n        >\n          Decode Address to Args and LockHash\n        </h3>\n\n        <input style={{width: '30rem'}} type=\"text\" name=\"addr\" value={this.state.decodeAddr} onChange={this.upDecodeAddr}/>\n        <br/>\n        <br/>\n\n        <button onClick={this.onEncodeAddress}>Encode</button>\n        <br/>\n        <br/>\n\n        <div><strong>address</strong>: {addr}</div>\n        <br/>\n\n        <div><strong>hashType</strong>: {hashType}</div>\n        <br/>\n\n        <div><strong>codeHash</strong>: {codeHash}</div>\n        <br/>\n\n        <div><strong>args</strong>: {args}</div>\n        <br/>\n\n        <div><strong>lockHash</strong>: {lockHash}</div>\n        <br/>\n        <br/>\n      </Layout>\n    )\n  }\n}\n\nexport default BlogIndex\n\nexport const pageQuery = graphql`\n  query {\n    site {\n      siteMetadata {\n        title\n      }\n    }\n  }\n`\n","'use strict';\n\nrequire(\"core-js/modules/es6.array.is-array\");\n\nrequire(\"core-js/modules/es6.array.last-index-of\");\n\nvar ALPHABET = 'qpzry9x8gf2tvdw0s3jn54khce6mua7l'; // pre-compute lookup table\n\nvar ALPHABET_MAP = {};\n\nfor (var z = 0; z < ALPHABET.length; z++) {\n  var x = ALPHABET.charAt(z);\n  if (ALPHABET_MAP[x] !== undefined) throw new TypeError(x + ' is ambiguous');\n  ALPHABET_MAP[x] = z;\n}\n\nfunction polymodStep(pre) {\n  var b = pre >> 25;\n  return (pre & 0x1FFFFFF) << 5 ^ -(b >> 0 & 1) & 0x3b6a57b2 ^ -(b >> 1 & 1) & 0x26508e6d ^ -(b >> 2 & 1) & 0x1ea119fa ^ -(b >> 3 & 1) & 0x3d4233dd ^ -(b >> 4 & 1) & 0x2a1462b3;\n}\n\nfunction prefixChk(prefix) {\n  var chk = 1;\n\n  for (var i = 0; i < prefix.length; ++i) {\n    var c = prefix.charCodeAt(i);\n    if (c < 33 || c > 126) return 'Invalid prefix (' + prefix + ')';\n    chk = polymodStep(chk) ^ c >> 5;\n  }\n\n  chk = polymodStep(chk);\n\n  for (i = 0; i < prefix.length; ++i) {\n    var v = prefix.charCodeAt(i);\n    chk = polymodStep(chk) ^ v & 0x1f;\n  }\n\n  return chk;\n}\n\nfunction encode(prefix, words, LIMIT) {\n  LIMIT = LIMIT || 90;\n  if (prefix.length + 7 + words.length > LIMIT) throw new TypeError('Exceeds length limit');\n  prefix = prefix.toLowerCase(); // determine chk mod\n\n  var chk = prefixChk(prefix);\n  if (typeof chk === 'string') throw new Error(chk);\n  var result = prefix + '1';\n\n  for (var i = 0; i < words.length; ++i) {\n    var x = words[i];\n    if (x >> 5 !== 0) throw new Error('Non 5-bit word');\n    chk = polymodStep(chk) ^ x;\n    result += ALPHABET.charAt(x);\n  }\n\n  for (i = 0; i < 6; ++i) {\n    chk = polymodStep(chk);\n  }\n\n  chk ^= 1;\n\n  for (i = 0; i < 6; ++i) {\n    var v = chk >> (5 - i) * 5 & 0x1f;\n    result += ALPHABET.charAt(v);\n  }\n\n  return result;\n}\n\nfunction __decode(str, LIMIT) {\n  LIMIT = LIMIT || 90;\n  if (str.length < 8) return str + ' too short';\n  if (str.length > LIMIT) return 'Exceeds length limit'; // don't allow mixed case\n\n  var lowered = str.toLowerCase();\n  var uppered = str.toUpperCase();\n  if (str !== lowered && str !== uppered) return 'Mixed-case string ' + str;\n  str = lowered;\n  var split = str.lastIndexOf('1');\n  if (split === -1) return 'No separator character for ' + str;\n  if (split === 0) return 'Missing prefix for ' + str;\n  var prefix = str.slice(0, split);\n  var wordChars = str.slice(split + 1);\n  if (wordChars.length < 6) return 'Data too short';\n  var chk = prefixChk(prefix);\n  if (typeof chk === 'string') return chk;\n  var words = [];\n\n  for (var i = 0; i < wordChars.length; ++i) {\n    var c = wordChars.charAt(i);\n    var v = ALPHABET_MAP[c];\n    if (v === undefined) return 'Unknown character ' + c;\n    chk = polymodStep(chk) ^ v; // not in the checksum?\n\n    if (i + 6 >= wordChars.length) continue;\n    words.push(v);\n  }\n\n  if (chk !== 1) return 'Invalid checksum for ' + str;\n  return {\n    prefix: prefix,\n    words: words\n  };\n}\n\nfunction decodeUnsafe() {\n  var res = __decode.apply(null, arguments);\n\n  if (typeof res === 'object') return res;\n}\n\nfunction decode(str) {\n  var res = __decode.apply(null, arguments);\n\n  if (typeof res === 'object') return res;\n  throw new Error(res);\n}\n\nfunction convert(data, inBits, outBits, pad) {\n  var value = 0;\n  var bits = 0;\n  var maxV = (1 << outBits) - 1;\n  var result = [];\n\n  for (var i = 0; i < data.length; ++i) {\n    value = value << inBits | data[i];\n    bits += inBits;\n\n    while (bits >= outBits) {\n      bits -= outBits;\n      result.push(value >> bits & maxV);\n    }\n  }\n\n  if (pad) {\n    if (bits > 0) {\n      result.push(value << outBits - bits & maxV);\n    }\n  } else {\n    if (bits >= inBits) return 'Excess padding';\n    if (value << outBits - bits & maxV) return 'Non-zero padding';\n  }\n\n  return result;\n}\n\nfunction toWordsUnsafe(bytes) {\n  var res = convert(bytes, 8, 5, true);\n  if (Array.isArray(res)) return res;\n}\n\nfunction toWords(bytes) {\n  var res = convert(bytes, 8, 5, true);\n  if (Array.isArray(res)) return res;\n  throw new Error(res);\n}\n\nfunction fromWordsUnsafe(words) {\n  var res = convert(words, 5, 8, false);\n  if (Array.isArray(res)) return res;\n}\n\nfunction fromWords(words) {\n  var res = convert(words, 5, 8, false);\n  if (Array.isArray(res)) return res;\n  throw new Error(res);\n}\n\nmodule.exports = {\n  decodeUnsafe: decodeUnsafe,\n  decode: decode,\n  encode: encode,\n  toWordsUnsafe: toWordsUnsafe,\n  toWords: toWords,\n  fromWordsUnsafe: fromWordsUnsafe,\n  fromWords: fromWords\n};"],"sourceRoot":""}